# è¯ç‰©ç›¸äº’ä½œç”¨AI Agent - å¿«é€Ÿå¼€å§‹

## ğŸ¯ é¡¹ç›®å·²æˆåŠŸé‡æ„

æ ¹æ® `gole.md` çš„è¦æ±‚ï¼Œæœ¬é¡¹ç›®å·²ç»æˆåŠŸé›†æˆäº†**ç¬¦åˆFDA CDSæ ‡å‡†çš„è¯ç‰©ç›¸äº’ä½œç”¨AI Agentç³»ç»Ÿ**ã€‚

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. æ ¸å¿ƒæœåŠ¡å±‚
- âœ… **RxNorm APIé€‚é…å™¨** - è¯ç‰©æ ‡å‡†åŒ–å‘½åå’ŒéªŒè¯
- âœ… **OpenFDA APIé€‚é…å™¨** - FDAå®˜æ–¹è¯å“æ ‡ç­¾å’Œè­¦å‘Šä¿¡æ¯
- âœ… **AI AgentæœåŠ¡** - æ”¯æŒOpenAI GPT-4o/GPT-4o-miniå’ŒAnthropic Claude
- âœ… **ä¸‰å±‚éªŒè¯æ¶æ„** - é¢„AIéªŒè¯ â†’ AIç”Ÿæˆ â†’ åAIéªŒè¯

### 2. APIç«¯ç‚¹
- âœ… `/api/v1/medication/ask-medication` - ç”¨è¯å’¨è¯¢
- âœ… `/api/v1/medication/check-interaction` - è¯ç‰©ç›¸äº’ä½œç”¨æ£€æŸ¥
- âœ… `/api/v1/medication/disclaimer` - åŒ»ç–—å…è´£å£°æ˜
- âœ… `/api/v1/medication/validate-drug` - è¯ç‰©åç§°éªŒè¯
- âœ… `/api/v1/medication/drug-info/{drug_name}` - è¯ç‰©åŸºæœ¬ä¿¡æ¯

### 3. åˆè§„æ€§å’Œå®‰å…¨æ€§
- âœ… **FDA CDSéåŒ»ç–—å™¨æ¢°æ ‡å‡†** - å®Œå…¨ç¬¦åˆ
- âœ… **å¼ºåˆ¶å…è´£å£°æ˜** - æ¯ä¸ªå“åº”éƒ½åŒ…å«
- âœ… **å¤šå±‚éªŒè¯** - é˜²æ­¢AIå¹»è§‰å’Œé”™è¯¯å»ºè®®
- âœ… **å®‰å…¨çº¦æŸæç¤ºè¯** - ä»…æä¾›æ•™è‚²ä¿¡æ¯ï¼Œä¸æ›¿ä»£åŒ»ç–—å»ºè®®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®APIå¯†é’¥

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„OpenAIæˆ–Anthropic APIå¯†é’¥ï¼š

```bash
# è‡³å°‘é…ç½®å…¶ä¸­ä¸€ä¸ª
OPENAI_API_KEY=sk-your-openai-api-key-here
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here

# é€‰æ‹©AIæ¨¡å‹ï¼ˆå¯é€‰ï¼‰
AI_MODEL=gpt-4o-mini  # æ¨èï¼šæˆæœ¬ä½ï¼Œé€Ÿåº¦å¿«
# AI_MODEL=gpt-4o     # ç”Ÿäº§ç¯å¢ƒï¼šå‡†ç¡®æ€§é«˜
# AI_MODEL=claude-3-5-sonnet-20241022  # å®‰å…¨æ€§æœ€ä½³
```

### 2. å®‰è£…ä¾èµ–

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate

# å®‰è£…ä¾èµ–ï¼ˆå·²å®Œæˆï¼‰
pip install -r requirements/base.txt
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼ï¼ˆå¸¦è‡ªåŠ¨é‡è½½ï¼‰
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. è®¿é—®APIæ–‡æ¡£

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ§ª æµ‹è¯•AI Agent

### æ–¹æ³•1: è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
python test_ai_agent.py
```

è¿™å°†æµ‹è¯•ï¼š
- âœ… RxNorm APIè¿æ¥
- âœ… OpenFDA APIè¿æ¥
- âœ… AIç”¨è¯å’¨è¯¢åŠŸèƒ½
- âœ… è¯ç‰©ç›¸äº’ä½œç”¨æ£€æŸ¥

### æ–¹æ³•2: ä½¿ç”¨curlæµ‹è¯•

```bash
# æµ‹è¯•ç”¨è¯å’¨è¯¢
curl -X POST "http://localhost:8000/api/v1/medication/ask-medication" \
  -H "Content-Type: application/json" \
  -d '{
    "drug_name": "aspirin",
    "question": "What are the common side effects?"
  }'

# æµ‹è¯•è¯ç‰©ç›¸äº’ä½œç”¨
curl -X POST "http://localhost:8000/api/v1/medication/check-interaction" \
  -H "Content-Type: application/json" \
  -d '{
    "drug1": "warfarin",
    "drug2": "aspirin"
  }'
```

### æ–¹æ³•3: ä½¿ç”¨Swagger UI

1. è®¿é—® http://localhost:8000/docs
2. å±•å¼€ `/api/v1/medication/ask-medication`
3. ç‚¹å‡» "Try it out"
4. è¾“å…¥æµ‹è¯•æ•°æ®
5. ç‚¹å‡» "Execute"

## ğŸ“ é¡¹ç›®ç»“æ„

```
medical_net/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ medication.py       # æ–°å¢ï¼šè¯ç‰©å’¨è¯¢APIç«¯ç‚¹
â”‚   â”‚       â””â”€â”€ routes.py           # æ›´æ–°ï¼šåŒ…å«medicationè·¯ç”±
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ config.py               # æ›´æ–°ï¼šæ·»åŠ AI APIé…ç½®
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ ai_agent_service.py     # æ–°å¢ï¼šAI Agentæ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ rxnorm_service.py       # æ–°å¢ï¼šRxNorm APIé€‚é…å™¨
â”‚   â”‚   â””â”€â”€ openfda_service.py      # æ–°å¢ï¼šOpenFDA APIé€‚é…å™¨
â”‚   â””â”€â”€ schemas/
â”‚       â””â”€â”€ medication.py           # æ–°å¢ï¼šè¯ç‰©å’¨è¯¢ç›¸å…³æ¨¡å‹
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ AI_AGENT_GUIDE.md          # æ–°å¢ï¼šå®Œæ•´ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ test_ai_agent.py               # æ–°å¢ï¼šæµ‹è¯•è„šæœ¬
â”œâ”€â”€ requirements/
â”‚   â””â”€â”€ base.txt                   # æ›´æ–°ï¼šæ·»åŠ openai, anthropic
â””â”€â”€ .env                           # æ›´æ–°ï¼šæ·»åŠ AI APIå¯†é’¥é…ç½®
```

## ğŸ“Š APIä½¿ç”¨ç¤ºä¾‹

### ç”¨è¯å’¨è¯¢

**è¯·æ±‚**:
```json
POST /api/v1/medication/ask-medication
{
  "drug_name": "metformin",
  "question": "How should I take this medication?"
}
```

**å“åº”**:
```json
{
  "success": true,
  "drug_name": "metformin",
  "question": "How should I take this medication?",
  "answer": "æ ¹æ®FDAæ‰¹å‡†çš„è¯å“æ ‡ç­¾ï¼ŒMetforminï¼ˆäºŒç”²åŒèƒï¼‰çš„æœç”¨å»ºè®®åŒ…æ‹¬ï¼š\n\n1. **å‰‚é‡å’Œç”¨æ³•**ï¼š...\n2. **æœ€ä½³æœç”¨æ—¶é—´**ï¼š...\n\n**é‡è¦æé†’**ï¼šè¿™äº›æ˜¯ä¸€èˆ¬æ€§æ•™è‚²ä¿¡æ¯ã€‚æ‚¨çš„å…·ä½“å‰‚é‡å’Œç”¨è¯æ–¹æ¡ˆåº”ç”±æ‚¨çš„åŒ»ç–—ä¿å¥æä¾›è€…æ ¹æ®æ‚¨çš„ä¸ªäººå¥åº·çŠ¶å†µç¡®å®š...",
  "disclaimer": "æ­¤ä¿¡æ¯ä»…ä¾›æ•™è‚²ç”¨é€”ï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—å»ºè®®...",
  "severity": "info",
  "sources": ["FDA Drug Label", "RxNorm"]
}
```

### è¯ç‰©ç›¸äº’ä½œç”¨æ£€æŸ¥

**è¯·æ±‚**:
```json
POST /api/v1/medication/check-interaction
{
  "drug1": "warfarin",
  "drug2": "aspirin"
}
```

**å“åº”**:
```json
{
  "success": true,
  "drug1": "warfarin",
  "drug2": "aspirin",
  "found_interactions": true,
  "interactions": [
    {
      "drug": "warfarin",
      "interacts_with": "aspirin",
      "description": "è”åˆä½¿ç”¨å¯èƒ½å¢åŠ å‡ºè¡€é£é™©...",
      "severity": "ä¸­åº¦",
      "source": "FDA Label"
    }
  ],
  "recommendation": "è¯·ä¸æ‚¨çš„åŒ»ç–—ä¿å¥æä¾›è€…è®¨è®ºè¿™äº›è¯ç‰©çš„è”åˆä½¿ç”¨ã€‚",
  "disclaimer": "æ­¤ä¿¡æ¯ä»…ä¾›æ•™è‚²ç”¨é€”..."
}
```

## ğŸ”’ å®‰å…¨æ€§å’Œåˆè§„æ€§

### FDA CDSéåŒ»ç–—å™¨æ¢°æ ‡å‡†

æœ¬ç³»ç»Ÿå®Œå…¨ç¬¦åˆFDA 2022å¹´9æœˆç»ˆç‰ˆæŒ‡å—çš„å››é¡¹æ ‡å‡†ï¼š

1. âœ… ä¸è·å–åŒ»ç–—å½±åƒæˆ–è¯Šæ–­è®¾å¤‡ä¿¡å·
2. âœ… æ˜¾ç¤ºå’Œåˆ†æåŒ»ç–—ä¿¡æ¯ï¼ˆæ¥è‡ªFDAå’ŒRxNormï¼‰
3. âœ… æä¾›å»ºè®®æ”¯æŒä½†ä¸æä¾›å…·ä½“æŒ‡ä»¤
   - æä¾›é€‰é¡¹åˆ—è¡¨è€Œéå•ä¸€å»ºè®®
   - å§‹ç»ˆå¼•å¯¼ç”¨æˆ·å’¨è¯¢åŒ»ç–—ä¸“ä¸šäººå‘˜
4. âœ… å…è®¸åŒ»ç–—ä¸“ä¸šäººå‘˜å®¡æŸ¥ä¾æ®
   - é€æ˜çš„ä¿¡æ¯æ¥æº
   - å¯å®¡æŸ¥çš„ç®—æ³•é€»è¾‘

### å¤šå±‚éªŒè¯æ¶æ„

```
ç”¨æˆ·è¯·æ±‚ â†’ ã€é¢„AIéªŒè¯ã€‘ â†’ ã€AIç”Ÿæˆã€‘ â†’ ã€åAIéªŒè¯ã€‘ â†’ å“åº”
              â†“              â†“             â†“
          è¾“å…¥æ¸…ç†        å®‰å…¨æç¤ºè¯    ç›¸äº’ä½œç”¨æ£€æŸ¥
          RxNorméªŒè¯      FDAæ•°æ®      ä¸¥é‡ç¨‹åº¦åˆ†çº§
          é€Ÿç‡é™åˆ¶        ä½æ¸©åº¦0.3    å¼ºåˆ¶å…è´£å£°æ˜
```

## ğŸ’° æˆæœ¬ä¼°ç®—

### å¼€å‘/æµ‹è¯•é˜¶æ®µ
- **AI API**: ä½¿ç”¨GPT-4o-miniï¼Œçº¦$5-10/æœˆ
- **å¤–éƒ¨API**: RxNormå’ŒOpenFDAå®Œå…¨å…è´¹
- **æ€»æˆæœ¬**: < $15/æœˆ

### ç”Ÿäº§ç¯å¢ƒï¼ˆ10,000ç”¨æˆ·ï¼Œæ¯å¤©50æ¬¡æŸ¥è¯¢ï¼‰
- **AI API**: ä½¿ç”¨GPT-4oï¼Œçº¦$200-300/æœˆ
- **æ‰˜ç®¡**: Railway/Renderï¼Œçº¦$50/æœˆ
- **æ•°æ®åº“**: Supabase Proï¼Œ$25/æœˆ
- **æ€»æˆæœ¬**: $275-375/æœˆ

## ğŸ“š è¯¦ç»†æ–‡æ¡£

è¯·æŸ¥çœ‹ [AI_AGENT_GUIDE.md](docs/AI_AGENT_GUIDE.md) è·å–ï¼š
- æ¶æ„è®¾è®¡è¯¦è§£
- å®Œæ•´APIæ–‡æ¡£
- é…ç½®è¯´æ˜
- æ•…éšœæ’é™¤
- ä¸‹ä¸€æ­¥å¼€å‘å»ºè®®

## âš ï¸ é‡è¦æé†’

### æ³•å¾‹å…è´£å£°æ˜

æœ¬è½¯ä»¶ä»…ä¾›**æ•™è‚²å’Œç ”ç©¶ç”¨é€”**ã€‚

- âŒ ä¸å¾—ç”¨äºå®é™…ä¸´åºŠå†³ç­–ï¼Œé™¤éè·å¾—é€‚å½“çš„åŒ»ç–—ç›‘ç£å’Œæ³•å¾‹æ‰¹å‡†
- âŒ å¼€å‘è€…ä¸å¯¹ä»»ä½•åŒ»ç–—å»ºè®®ã€è¯Šæ–­æˆ–æ²»ç–—è´Ÿè´£
- âš ï¸ ä½¿ç”¨æœ¬è½¯ä»¶çš„é£é™©ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰

åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼Œè¯·ï¼š

1. âœ… å’¨è¯¢æ³•å¾‹é¡¾é—®ç¡®è®¤åˆè§„æ€§
2. âœ… è·å¾—ä¸“ä¸šè´£ä»»ä¿é™©ï¼ˆE&Oä¿é™©ï¼‰
3. âœ… è¿›è¡Œå®Œæ•´çš„å®‰å…¨å®¡è®¡
4. âœ… è®©è¯å‰‚å¸ˆå®¡æŸ¥AIç”Ÿæˆçš„å†…å®¹
5. âœ… å®æ–½å®Œæ•´çš„ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
6. âœ… å‡†å¤‡ç”¨æˆ·éšç§æ”¿ç­–å’ŒæœåŠ¡æ¡æ¬¾

## ğŸ‰ æ€»ç»“

é¡¹ç›®å·²æˆåŠŸé‡æ„ï¼Œç°åœ¨å…·å¤‡ï¼š

- âœ… ç¬¦åˆFDAæ ‡å‡†çš„AIè¯ç‰©å’¨è¯¢ç³»ç»Ÿ
- âœ… å¤šæ•°æ®æºé›†æˆï¼ˆRxNorm + OpenFDAï¼‰
- âœ… å¤šå±‚éªŒè¯å®‰å…¨æ¶æ„
- âœ… å®Œæ•´çš„APIç«¯ç‚¹å’Œæ–‡æ¡£
- âœ… å¼ºåˆ¶åŒ»ç–—å…è´£å£°æ˜
- âœ… çµæ´»çš„AIæ¨¡å‹é€‰æ‹©

**ä¸‹ä¸€æ­¥**: é…ç½®APIå¯†é’¥å¹¶è¿è¡Œ `python test_ai_agent.py` å¼€å§‹æµ‹è¯•ï¼

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- [å®Œæ•´ä½¿ç”¨æŒ‡å—](docs/AI_AGENT_GUIDE.md)
- [RxNorm APIæ–‡æ¡£](https://lhncbc.nlm.nih.gov/RxNav/APIs/)
- [OpenFDA APIæ–‡æ¡£](https://open.fda.gov/apis/)
- [OpenAI APIæ–‡æ¡£](https://platform.openai.com/docs)
